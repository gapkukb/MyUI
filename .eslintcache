[{"C:\\workspace\\ui\\src\\index.tsx":"1","C:\\workspace\\ui\\src\\reportWebVitals.ts":"2","C:\\workspace\\ui\\src\\App.tsx":"3","C:\\workspace\\ui\\src\\package\\icon\\index.tsx":"4","C:\\workspace\\ui\\src\\package\\button\\index.tsx":"5","C:\\workspace\\ui\\src\\package\\field\\index.tsx":"6","C:\\workspace\\ui\\src\\util\\bem.ts":"7","C:\\workspace\\ui\\src\\util\\unit.ts":"8","C:\\workspace\\ui\\src\\util\\index.ts":"9","C:\\workspace\\ui\\src\\util\\type.ts":"10","C:\\workspace\\ui\\src\\package\\loading\\index.tsx":"11","C:\\workspace\\ui\\src\\util\\regexp.ts":"12","C:\\workspace\\ui\\src\\util\\dom.ts":"13","C:\\workspace\\ui\\src\\util\\global.ts":"14","C:\\workspace\\ui\\src\\package\\stepper\\index.tsx":"15","C:\\workspace\\ui\\src\\package\\switch\\index.tsx":"16","C:\\workspace\\ui\\src\\package\\portal\\index.tsx":"17","C:\\workspace\\ui\\src\\package\\dialog\\index.tsx":"18","C:\\workspace\\ui\\src\\package\\portal\\pure.tsx":"19","C:\\workspace\\ui\\src\\package\\popup\\index.tsx":"20","C:\\workspace\\ui\\src\\package\\portal\\util.ts":"21","C:\\workspace\\ui\\src\\package\\dialog\\dom.tsx":"22"},{"size":664,"mtime":1614649325486,"results":"23","hashOfConfig":"24"},{"size":440,"mtime":1612460464033,"results":"25","hashOfConfig":"24"},{"size":1034,"mtime":1616549078430,"results":"26","hashOfConfig":"24"},{"size":1086,"mtime":1615251077383,"results":"27","hashOfConfig":"28"},{"size":2952,"mtime":1615552105700,"results":"29","hashOfConfig":"28"},{"size":8264,"mtime":1615381334603,"results":"30","hashOfConfig":"28"},{"size":919,"mtime":1612852215479,"results":"31","hashOfConfig":"28"},{"size":592,"mtime":1615254407065,"results":"32","hashOfConfig":"28"},{"size":1797,"mtime":1615370824856,"results":"33","hashOfConfig":"24"},{"size":1828,"mtime":1613266652038,"results":"34","hashOfConfig":"24"},{"size":2063,"mtime":1615538587012,"results":"35","hashOfConfig":"28"},{"size":476,"mtime":1615292408862,"results":"36","hashOfConfig":"24"},{"size":4331,"mtime":1615705391210,"results":"37","hashOfConfig":"24"},{"size":1082,"mtime":1615575446282,"results":"38","hashOfConfig":"24"},{"size":4479,"mtime":1615382398017,"results":"39","hashOfConfig":"28"},{"size":1675,"mtime":1615454650140,"results":"40","hashOfConfig":"28"},{"size":6461,"mtime":1616547147905,"results":"41","hashOfConfig":"24"},{"size":2808,"mtime":1616549238009,"results":"42","hashOfConfig":"24"},{"size":1775,"mtime":1615968408425,"results":"43","hashOfConfig":"24"},{"size":1100,"mtime":1616564357664,"results":"44","hashOfConfig":"24"},{"size":2929,"mtime":1616546967896,"results":"45","hashOfConfig":"24"},{"size":2951,"mtime":1616198326632,"results":"46","hashOfConfig":"24"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"49","usedDeprecatedRules":"50"},"2fh3k2",{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"55","usedDeprecatedRules":"50"},{"filePath":"56","messages":"57","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"58"},"gsctrs",{"filePath":"59","messages":"60","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":1,"source":null},{"filePath":"61","messages":"62","errorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"63","messages":"64","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"65"},{"filePath":"66","messages":"67","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"58"},{"filePath":"68","messages":"69","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"70"},{"filePath":"71","messages":"72","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"70"},{"filePath":"73","messages":"74","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"58"},{"filePath":"75","messages":"76","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"70"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"70"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"70"},{"filePath":"81","messages":"82","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"83","usedDeprecatedRules":"84"},{"filePath":"85","messages":"86","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"87","messages":"88","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"89","usedDeprecatedRules":"70"},{"filePath":"90","messages":"91","errorCount":1,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"92","messages":"93","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"94","usedDeprecatedRules":"70"},{"filePath":"95","messages":"96","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"97"},{"filePath":"98","messages":"99","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"100","usedDeprecatedRules":"70"},{"filePath":"101","messages":"102","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"103","usedDeprecatedRules":"70"},"C:\\workspace\\ui\\src\\index.tsx",["104","105"],"import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport { config } from \"./package/async-view\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport \"./stylus/index.styl\";\r\nimport { version } from \"../package.json\";\r\n\r\n// document.documentElement.dataset.ui = version;\r\n\r\nReactDOM.render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>,\r\n\tdocument.getElementById(\"app\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n",["106","107"],"C:\\workspace\\ui\\src\\reportWebVitals.ts",[],"C:\\workspace\\ui\\src\\App.tsx",["108"],"import React, { Component } from \"react\";\r\nimport { Dialog } from \"./package/dialog\";\r\nimport Popup from \"./package/popup\";\r\n\r\nclass App extends Component {\r\n\tstate = { visible: false };\r\n\r\n\tsetVisible = (visible: boolean) => {\r\n\t\tthis.setState({ visible });\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<button onClick={() => this.setVisible(true)}>显示</button>\r\n\t\t\t\t{/* <Dialog\r\n\t\t\t\t\tvisible={this.state.visible}\r\n\t\t\t\t\tonClose={() => this.setVisible(false)}\r\n\t\t\t\t\tfooter={<button onClick={() => this.setVisible(false)}>关闭</button>}\r\n\t\t\t\t\ttitle=\"对话框\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<p>对话框内容</p>\r\n\t\t\t\t\t<p>对话框其他内容</p>\r\n\t\t\t\t</Dialog>\r\n\t\t\t\t<Dialog\r\n\t\t\t\t\tvisible={this.state.visible}\r\n\t\t\t\t\tonClose={() => this.setVisible(false)}\r\n\t\t\t\t\tfooter={<button onClick={() => this.setVisible(false)}>关闭</button>}\r\n\t\t\t\t\ttitle=\"对话框\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<p>对话框内容</p>\r\n\t\t\t\t\t<p>对话框其他内容</p>\r\n\t\t\t\t</Dialog> */}\r\n\t\t\t\t<Popup visible={this.state.visible}></Popup>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\nexport default App;\r\n","C:\\workspace\\ui\\src\\package\\icon\\index.tsx",[],["109","110"],"C:\\workspace\\ui\\src\\package\\button\\index.tsx",["111","112","113","114"],"C:\\workspace\\ui\\src\\package\\field\\index.tsx",["115","116","117","118","119","120","121","122","123","124"],"C:\\workspace\\ui\\src\\util\\bem.ts",[],["125","126"],"C:\\workspace\\ui\\src\\util\\unit.ts",[],"C:\\workspace\\ui\\src\\util\\index.ts",[],["127","128"],"C:\\workspace\\ui\\src\\util\\type.ts",[],"C:\\workspace\\ui\\src\\package\\loading\\index.tsx",[],"C:\\workspace\\ui\\src\\util\\regexp.ts",[],"C:\\workspace\\ui\\src\\util\\dom.ts",[],"C:\\workspace\\ui\\src\\util\\global.ts",[],"C:\\workspace\\ui\\src\\package\\stepper\\index.tsx",["129","130","131","132"],"import { FC, CSSProperties, useState, useRef, FormEvent, useEffect, KeyboardEvent } from \"react\";\r\nimport classnames from \"classnames\";\r\nimport \"./index.styl\";\r\nimport { FieldProps } from \"../field\";\r\nimport Button, { ButtonProps } from \"../button\";\r\nimport { call, number } from \"../../util\";\r\nimport { fixUnit } from \"../../util/unit\";\r\nexport type StepperProps = Partial<{\r\n\t/** 最小值，失去焦点时触发 */\r\n\tmin: Numeric;\r\n\t/** 最大值，失去焦点时触发 */\r\n\tmax: Numeric;\r\n\t/** 步长 */\r\n\tstep: Numeric;\r\n\t/** 小数位 */\r\n\tdecimal: Numeric;\r\n\t/** 异步函数,参数是需要设置的具体值,函参done的回参-false 不变,true正常变化 numeric 直接设置值 */\r\n\tasyncFunc: (done: (ret: boolean | Numeric) => void, value?: Numeric) => void;\r\n\t/** 可输入数字 */\r\n\teditable: boolean;\r\n\t/** 显示减少按钮 */\r\n\tshowDecrease: boolean;\r\n\t/** 显示增加按钮 */\r\n\tshowIncrease: boolean;\r\n\t/** 禁用减少按钮 */\r\n\tdisableDecrease: boolean;\r\n\t/** 禁用增加按钮 */\r\n\tdisableIncrease: boolean;\r\n\t/** 按钮大小 */\r\n\tbuttonSize: ButtonProps[\"size\"];\r\n\t/** 文字对齐 */\r\n\talign: FieldProps[\"inputAlign\"];\r\n\t/** 回调函数 */\r\n\tonChange: (output: number) => any;\r\n}> &\r\n\tPick<FieldProps, \"width\" | \"defaultValue\" | \"disabled\" | \"readOnly\" | \"placeholder\" | \"formatter\" | \"trigger\">;\r\n\r\nexport const Stepper: CFC<StepperProps> = ({\r\n\tmin,\r\n\tmax,\r\n\tdecimal: _decimal = 0,\r\n\twidth,\r\n\tdefaultValue,\r\n\treadOnly,\r\n\tplaceholder,\r\n\tstep = 1,\r\n\tasyncFunc,\r\n\teditable,\r\n\tshowDecrease,\r\n\tshowIncrease,\r\n\tdisableDecrease,\r\n\tdisableIncrease,\r\n\tdisabled,\r\n\tclassName,\r\n\tstyle,\r\n\tchildren,\r\n\tformatter,\r\n\tbuttonSize = \"mini\",\r\n\talign = \"center\",\r\n\tonChange,\r\n\t...rest\r\n}) => {\r\n\tconst decimal = number(_decimal)!;\r\n\tconst [value, setValue] = useState(number(defaultValue));\r\n\tconst inputRef = useRef<HTMLInputElement>(null);\r\n\r\n\tconst _disableDecrease = disabled || disableDecrease || ((value && min && value <= min) as boolean);\r\n\tconst _disableIncrease = disabled || disableIncrease || ((value && max && value >= max) as boolean);\r\n\r\n\tfunction update(input: number | FormEvent<HTMLInputElement>) {\r\n\t\tlet output: number;\r\n\t\tif (typeof input === \"number\") {\r\n\t\t\toutput = input;\r\n\t\t} else {\r\n\t\t\tconst el = input.currentTarget;\r\n\t\t\toutput = el.valueAsNumber;\r\n\t\t\tif (input.type === \"blur\") {\r\n\t\t\t\tif (max && output > max) {\r\n\t\t\t\t\toutput = Number(max);\r\n\t\t\t\t} else if (min && output < min) {\r\n\t\t\t\t\toutput = Number(min);\r\n\t\t\t\t}\r\n\t\t\t\tif (formatter) {\r\n\t\t\t\t\toutput = formatter(output);\r\n\t\t\t\t}\r\n\t\t\t\tel.value = \"\";\r\n\t\t\t\tel.value = ((output as unknown) as string) || \"\";\r\n\t\t\t} else {\r\n\t\t\t\tif ((max && output > max) || (min && output < min)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (output === value) return;\r\n\t\tif (asyncFunc) {\r\n\t\t\t// asyncFunc();\r\n\t\t}\r\n\t\tsetValue(output);\r\n\t\tcall(onChange, output);\r\n\t}\r\n\tfunction press(e: KeyboardEvent<HTMLInputElement>) {\r\n\t\tconst el = e.currentTarget;\r\n\t\tconst key = e.key;\r\n\t\tconst value = el.value;\r\n\t\tconst index = value.indexOf(\".\");\r\n\t\t//  处理+ - . 三种符号和小数位\r\n\t\tif (\r\n\t\t\tkey === \"+\" ||\r\n\t\t\t(key === \"0\" && value === \"\") ||\r\n\t\t\t(key === \".\" && (decimal === 0 || value === \"\")) ||\r\n\t\t\t(key === \"-\" && ((min && min >= 0) || !el.validity.valid)) ||\r\n\t\t\t(index !== -1 && value.substring(index).length > decimal)\r\n\t\t) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction set(action: \"stepDown\" | \"stepUp\") {\r\n\t\tconst el = inputRef.current!;\r\n\t\tel[action]();\r\n\t\tupdate(el.valueAsNumber);\r\n\t}\r\n\tconst decrease = set.bind(null, \"stepDown\");\r\n\tconst increase = set.bind(null, \"stepUp\");\r\n\treturn (\r\n\t\t<div className=\"stepper\" style={{ width: fixUnit(width) }}>\r\n\t\t\t<Button\r\n\t\t\t\tborderless\r\n\t\t\t\tround=\"no\"\r\n\t\t\t\ticon=\"wifi\"\r\n\t\t\t\tsize={buttonSize}\r\n\t\t\t\tdisabled={_disableDecrease}\r\n\t\t\t\tonClick={decrease}\r\n\t\t\t/>\r\n\t\t\t<input\r\n\t\t\t\tclassName={classnames(\"stepper__value\", align)}\r\n\t\t\t\ttype=\"number\"\r\n\t\t\t\tdefaultValue={value}\r\n\t\t\t\treadOnly={!editable}\r\n\t\t\t\tstep={step}\r\n\t\t\t\tonChange={update}\r\n\t\t\t\tonBlur={update}\r\n\t\t\t\tonKeyPress={press}\r\n\t\t\t\trole=\"stepper\"\r\n\t\t\t\tref={inputRef}\r\n\t\t\t\tmin={min}\r\n\t\t\t\tmax={max}\r\n\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\taria-valuemin={min as number}\r\n\t\t\t\taria-valuemax={max as number}\r\n\t\t\t\taria-valuenow={(value as unknown) as number}\r\n\t\t\t/>\r\n\t\t\t<Button\r\n\t\t\t\tborderless\r\n\t\t\t\tround=\"no\"\r\n\t\t\t\ticon=\"wifi\"\r\n\t\t\t\tsize={buttonSize}\r\n\t\t\t\tdisabled={_disableIncrease}\r\n\t\t\t\tonClick={increase}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\nStepper.displayName = Stepper.name;\r\nexport default Stepper;\r\n",["133","134"],"C:\\workspace\\ui\\src\\package\\switch\\index.tsx",["135","136"],"C:\\workspace\\ui\\src\\package\\portal\\index.tsx",["137","138","139","140","141"],"import {\n\tCSSProperties,\n\tforwardRef,\n\tReactNode,\n\tRefObject,\n\tuseEffect,\n\tuseImperativeHandle,\n\tuseLayoutEffect,\n\tuseMemo,\n\tuseRef,\n} from \"react\";\nimport { call, nope } from \"../../util\";\nimport classnames from \"classnames\";\nimport { PurePortal, PurePortalProps as _ } from \"./pure\";\nimport { CSR, on, querySelector, scrollbarWidth, setStyle } from \"../../util/dom\";\nimport memoize from \"memoize-one\";\nimport { patchElement, diffStyle, restoreElement, MountElement, assinStyle } from \"./util\";\nimport \"./index.styl\";\n\nexport { PurePortal };\nexport type PurePortalProps = _;\n/* \n弹层出现后,不希望body滚动,最佳实践是在移动端不要使用body作为容器,而使用一个根div容器,\n设置根div heigt:100vh;width:100vw;overflow:hidden auto\n*/\n\nexport enum ActionType {\n\t/** 点击确认按钮 */\n\tConfirm,\n\t/** 点击取消按钮 */\n\tCancel,\n\t/** 点击关闭按钮 */\n\tClose,\n\t/** 点击背景 */\n\tOverlay,\n\t/** 键盘esc抬起 */\n\tEsc,\n\t/** 点击外部 */\n\tOutside,\n\t/** 路由变化 */\n\tRouter,\n}\nexport type PortalProps = Partial<{\n\tid: string;\n\ttitle: string;\n\tcontent: string;\n\tclassName: string;\n\toverClasName: string;\n\ttype: string;\n\tstyle: CSSProperties;\n\toverlayStyle: CSSProperties;\n\ticon: \"loading\" | \"success\" | \"fail\" | \"warn\" | \"danger\";\n\toverlay: boolean;\n\tlockScroller: boolean;\n\topacity: Numeric;\n\tclosable: boolean;\n\tcloseIcon: string;\n\tcloseIconSide: \"left\" | \"right\";\n\tcloseByOutside: boolean;\n\tcloseByOverlay: boolean;\n\tcloseByESC: boolean;\n\tchildren: ReactNode;\n\tanimate: string;\n\tposition: \"left\" | \"right\" | \"top\" | \"bottom\" | \"center\" | [Numeric, Numeric];\n\ttime: number;\n\tarea: [Numeric?, Numeric?, Numeric?, Numeric?];\n\tmaxWidth: Numeric;\n\tmaxHeight: Numeric;\n\tfullscreen: boolean;\n\tdragable: boolean;\n\tdragAxis: \"x\" | \"y\" | \"all\";\n\tresize: boolean;\n\tbuttons: { text: string; id: Numeric; disabled: boolean; style: CSSProperties }[];\n\tvisible: boolean;\n\tonOpen(): void;\n\tonBeforeClose: AsyncCallBack<boolean | void, ActionType>;\n\tonClose(action: ActionType): void;\n\ttag: keyof HTMLElementTagNameMap;\n}> &\n\tPartial<PurePortalProps>;\n\nexport interface PortalImperativeHandlers {\n\tcontains(node: Node): boolean;\n\tpurePortalRef: RefObject<PurePortal | undefined>;\n\tcontainer: HTMLElement;\n}\n\nexport const Portal = forwardRef<PortalImperativeHandlers, PortalProps>((props, ref) => {\n\tconst {\n\t\tvisible = true,\n\t\ttag = \"div\",\n\t\tselector = document.body,\n\t\tcloseByESC,\n\t\tcloseByOutside,\n\t\tcloseByOverlay,\n\t\tlockScroller,\n\t\treplace,\n\t\tchildren,\n\t\tclassName,\n\t\tstyle,\n\t\tonBeforeClose,\n\t\tonClose,\n\t\tonOpen,\n\t} = props;\n\n\t// 背景层\n\tconst node = useMemo(() => (CSR ? document.createElement(tag) : null), [tag]) as HTMLElement;\n\t// 缓存对父级的引用\n\tconst getParent = useMemo(() => memoize(querySelector), []);\n\t// 缓存属性\n\tconst propsRef = useRef<PortalProps>(props);\n\tpropsRef.current = props;\n\tconst styleRef = useRef<CSSProperties | undefined>(style);\n\tconst purePortalRef = useRef<PurePortal>(null);\n\n\tconst closeAction = (action: ActionType) => {\n\t\tconst f = () => call(onClose, action);\n\t\tonBeforeClose ? onBeforeClose((state) => state && f(), action) : f();\n\t};\n\t// 函数组件不能对外暴露属性,\n\t// 使用useImperativeHandle 结合 forwardRef高阶组件,用来使ref对象对外暴露属性\n\tuseImperativeHandle<PortalImperativeHandlers, PortalImperativeHandlers>(\n\t\tref,\n\t\t() => ({\n\t\t\tcontains(node: Node) {\n\t\t\t\treturn purePortalRef.current?.contains(node) || false;\n\t\t\t},\n\t\t\tpurePortalRef: purePortalRef,\n\t\t\tcontainer: node,\n\t\t}),\n\t\t[node]\n\t);\n\t// 给背景层添加类名\n\tuseLayoutEffect(() => {\n\t\tclassName && (node.className = className);\n\t}, [node, className]);\n\t// 增量更新行内样式\n\tuseLayoutEffect(() => {\n\t\tconst result = diffStyle(styleRef.current || {}, style || {});\n\t\tsetStyle(node, result);\n\t\tstyleRef.current = style;\n\t}, [node, className]);\n\n\t// 当处于打开状态时,给蒙层添加定位\n\tuseLayoutEffect(() => {\n\t\tif (!visible || !closeByOverlay) return nope;\n\t\t// Promise.resolve().then(() => node.classList.add(\"fade\"));\n\t\tconst { position, left, right, top, bottom } = node.style;\n\t\tconst parent = getParent(selector);\n\n\t\tassinStyle(node, 0, 0, 0, 0, parent === document.body ? \"fixed\" : \"absolute\");\n\t\treturn () => assinStyle(node, left, right, top, bottom, position);\n\t}, [visible, selector, closeByOverlay, node, getParent]);\n\n\t// 锁定挂载对象,不允许滚动\n\tuseLayoutEffect(() => {\n\t\tconst parent = getParent(selector) as HTMLElement;\n\t\tconst size = scrollbarWidth(parent);\n\t\t// 判断是否打开状态,是否需要锁定,对象是否有滚动条\n\t\tif (!visible || !lockScroller || !size) return nope;\n\t\tpatchElement(parent, size);\n\t\tparent.classList.add(\"locked\");\n\t\treturn () => {\n\t\t\trestoreElement(parent);\n\t\t\tparent.classList.remove(\"locked\");\n\t\t};\n\t}, [selector, visible, lockScroller, getParent]);\n\n\t// 点击外部元素时关闭组件\n\tuseLayoutEffect(() => {\n\t\tlet cancel = nope;\n\t\t//如果开启了点击外部元素关闭\n\t\tif (closeByOutside) {\n\t\t\t// 如果有蒙层那么监听蒙层,否则监听整个window对象\n\t\t\tcancel = on(closeByOverlay ? node : window, \"click\", (e: MouseEvent) => {\n\t\t\t\tconst { visible } = propsRef.current;\n\t\t\t\tconst purePortal = purePortalRef.current;\n\t\t\t\tif (e.defaultPrevented || !visible || !purePortal) return;\n\t\t\t\tconst el = e.target;\n\t\t\t\t// 如果点击的不是node节点,或者不是组件元素本身,或者也不是组件的子元素,那么执行关闭逻辑\n\t\t\t\tif (el === node || !purePortal.contains(node)) {\n\t\t\t\t\tcloseAction(closeByOverlay ? ActionType.Overlay : ActionType.Outside);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcall(onOpen);\n\t\treturn cancel;\n\t}, [closeByOverlay, closeByOutside, node]);\n\n\t// ESC按键关闭\n\tuseEffect(() => {\n\t\tif (!closeByESC || !visible) return nope;\n\t\treturn on(document.body, \"keyup\", function (e) {\n\t\t\tconst esc = e.key === \"Escape\" || e.key === \"Esc\" || e.keyCode === 27;\n\t\t\tesc && closeAction(ActionType.Esc);\n\t\t});\n\t}, [closeByESC, visible]);\n\n\t// 挂载元素\n\tuseLayoutEffect(() => {\n\t\tconst parent = getParent(selector);\n\t\tif (!parent) return console.error(\"Maybe error: cannot mount the portal cause by invalid elment as null\");\n\t\tparent.appendChild(node);\n\t\treturn () => {\n\t\t\tparent.removeChild(node);\n\t\t};\n\t}, [node, selector, getParent]);\n\n\treturn visible && node ? (\n\t\t<PurePortal ref={purePortalRef} replace={replace} selector={node}>\n\t\t\t{/* <MountElement node={node} getParent={getParent} selector={selector} /> */}\n\t\t\t{children}\n\t\t</PurePortal>\n\t) : null;\n});\n","C:\\workspace\\ui\\src\\package\\dialog\\index.tsx",["142","143","144"],"C:\\workspace\\ui\\src\\package\\portal\\pure.tsx",["145"],"import { createContext, PureComponent } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport memoize from \"memoize-one\";\nimport { querySelector } from \"../../util/dom\";\n\nexport type Context = PurePortal[];\nexport const Context = createContext<Context>([]);\n\nexport type PurePortalProps = {\n\t/** 选择挂载元素 */\n\tselector: HTMLElement | string;\n\t/** 是否清空挂载元素的内容 */\n\treplace?: boolean;\n};\n\nexport class PurePortal extends PureComponent<PurePortalProps> {\n\tcontext!: Context;\n\tstatic contextType = Context;\n\tstatic defaultProps = {\n\t\treplace: true,\n\t};\n\tprivate readonly children: Context = [];\n\n\t/** 获取挂载点元素 并插入或替换子元素 */\n\tquerySelector = memoize((selector: string | HTMLElement): Element | null => {\n\t\tconst node = querySelector(selector);\n\t\tif (!node) return node;\n\t\tif (this.props.replace) node.innerHTML = \"\";\n\t\treturn node;\n\t});\n\t/** 判断当前组件挂载的元素下是否包含了目标元素 */\n\tcontains(node: Node) {\n\t\tconst el = this.querySelector(this.props.selector);\n\t\tif (!el) return false;\n\t\tif (el.contains(node)) return true;\n\t\t//TODO: 子组件不一定在父组件的作用域内,比如portal元素,所以还要判断子组件\n\t\tconst c = this.children;\n\t\tvar i = c.length;\n\t\twhile (i--) if (c[i].contains(node)) return true;\n\t\treturn false;\n\t}\n\tcomponentDidMount() {\n\t\tthis.children.push(this);\n\t}\n\tcomponentWillUnmount() {\n\t\tconst c = this.children;\n\t\tconst index = c.indexOf(this);\n\t\tindex !== -1 && c.splice(index, 1);\n\t}\n\trender() {\n\t\tconst { children, selector } = this.props;\n\t\tconst node = this.querySelector(selector);\n\t\tif (!node) return null;\n\t\treturn createPortal(<Context.Provider value={this.context}>{children}</Context.Provider>, node);\n\t}\n}\nexport default PurePortal;\n","C:\\workspace\\ui\\src\\package\\popup\\index.tsx",["146","147","148","149"],"import classnames from \"classnames\";\nimport React, { createRef, PureComponent, useRef } from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { Portal } from \"../portal\";\nimport \"./index.styl\";\nexport type PopupProps = Partial<{}> & { visible: boolean };\nexport type PopupState = Partial<{ fade: boolean }> & { show: boolean; animateClassname: string };\n\nexport class Popup extends PureComponent<PopupProps, PopupState> {\n\tconstructor(props: PopupProps) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tshow: props.visible,\n\t\t\tfade: false,\n\t\t\tanimateClassname: \"\",\n\t\t};\n\t}\n\tstatic defaultProps = {\n\t\tvisible: false,\n\t};\n\tstatic getDeriverdStateFromProps({ visible }: PopupProps, { show }: PopupState) {\n\t\tif (visible === show) return null;\n\t\treturn {\n\t\t\tprevOpen: visible,\n\t\t\texisting: visible,\n\t\t};\n\t}\n\tprivate nodeRef = createRef<HTMLDivElement>();\n\trender() {\n\t\tconst classname = \"fade\";\n\t\tconst { visible } = this.props;\n\t\treturn (\n\t\t\t<div ref={this.nodeRef} style={{ display: visible ? undefined : `none` }} className={classname}>\n\t\t\t\t3213\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Popup;\n","C:\\workspace\\ui\\src\\package\\portal\\util.ts",["150"],"import { CSSProperties, useLayoutEffect } from \"react\";\n\ninterface PatchMeta {\n\tcount: number;\n\tpaddingRight: CSSStyleDeclaration[\"paddingRight\"];\n\toverflow: CSSStyleDeclaration[\"overflow\"];\n}\n// 使用 new Map 存储元素的css属性的原本的值,用于更改之后的还原css\nconst patched = new Map<HTMLElement, PatchMeta>();\nexport function patchElement(parent: HTMLElement, size: number) {\n\tconst meta = patched.get(parent);\n\tif (meta) {\n\t\tmeta.count += 1;\n\t} else {\n\t\tconst { overflow, paddingRight } = parent.style;\n\t\t// 在原来的padding-right基础上增加滚动条宽度\n\t\tconst PDR = getComputedStyle(parent).paddingRight;\n\t\tconst newPDR = parseFloat(PDR) || 0 + size;\n\t\tObject.assign(parent.style, {\n\t\t\toverflow: \"hidden\",\n\t\t\tpaddingRight: newPDR + \"px\",\n\t\t});\n\t\tpatched.set(parent, {\n\t\t\tcount: 1,\n\t\t\toverflow,\n\t\t\tpaddingRight,\n\t\t});\n\t}\n}\nexport function restoreElement(parent: HTMLElement) {\n\tconst meta = patched.get(parent);\n\tif (!meta) {\n\t\tthrow new Error(\"This looks like a bug of component,contact us\");\n\t}\n\tif (meta.count === 1) {\n\t\tpatched.delete(parent);\n\t\tObject.assign(parent.style, {\n\t\t\toverflow: meta.overflow,\n\t\t\tpaddingRight: meta.paddingRight,\n\t\t});\n\t} else {\n\t\tmeta.count -= 1;\n\t}\n}\n\nexport function diffStyle<T = CSSProperties>(prev: T = {} as any, next: T = {} as any) {\n\tconst ret = {} as T;\n\tconst prevKeys = Object.keys(prev);\n\tconst nextKeys = Object.keys(next);\n\tlet i = prevKeys.length;\n\tlet key = \"\";\n\twhile (i--) {\n\t\tkey = prevKeys[i];\n\t\t// @ts-ignore\n\t\tif (!next[key]) ret[key] = \"\";\n\t}\n\ti = prevKeys.length;\n\twhile (i--) {\n\t\tkey = nextKeys[i];\n\t\t// @ts-ignore\n\t\tret[key] = next[key];\n\t}\n\treturn ret;\n}\n\nlet zindex = 100;\nconst outclickEvent = new CustomEvent(\"outclick\");\nconst overlay = {\n\tel: document.createElement(\"div\"),\n\ttoggle(value: \"none\" | \"\") {\n\t\tObject.assign(this.el.style, {\n\t\t\tdisplay: value,\n\t\t\tzIndex: zindex,\n\t\t});\n\t},\n\tshow() {\n\t\tzindex++;\n\t\tthis.toggle(\"\");\n\t},\n\thide() {\n\t\tzindex--;\n\t\tthis.toggle(\"none\");\n\t},\n\tinit() {\n\t\tthis.el.className = \"overlay\";\n\t\tdocument.body.appendChild(this.el);\n\t\tthis.el.onclick = function () {\n\t\t\tdocument.dispatchEvent(outclickEvent);\n\t\t};\n\t\t// this.hide();\n\t\treturn this;\n\t},\n}.init();\n\nexport function assinStyle(node: HTMLElement, left: Numeric, right: Numeric, top: Numeric, bottom: Numeric, p: string) {\n\tObject.assign(node.style, {\n\t\tleft,\n\t\tright,\n\t\ttop,\n\t\tbottom,\n\t\tposition: p,\n\t});\n}\n\nexport interface IMountElementProps {\n\tnode: HTMLElement;\n\tgetParent(selector: Element | string): Element | null;\n\tselector: Element | string;\n}\n\nexport const MountElement = ({ node, getParent, selector }: IMountElementProps) => {\n\tuseLayoutEffect(() => {\n\t\tconst parent = getParent(selector);\n\t\tif (!parent) return console.error(\"Maybe error: cannot mount the portal cause by invalid elment as null\");\n\t\tparent.appendChild(node);\n\t\treturn () => {\n\t\t\tparent.removeChild(node);\n\t\t};\n\t}, [node, selector, getParent]);\n\treturn null;\n};\n","C:\\workspace\\ui\\src\\package\\dialog\\dom.tsx",["151","152"],"import React, { createRef, isValidElement, PureComponent, ReactNode } from \"react\";\nimport { DialogProps } from \".\";\nimport { call } from \"../../util\";\nimport classnames from \"classnames\";\n\nexport interface MousePosition {\n\tx: number;\n\ty: number;\n}\n\nexport type DialogDOMProps = Partial<{\n\tfooter: ReactNode;\n\tmousePosition: MousePosition | null;\n}> &\n\tPick<DialogProps, \"className\" | \"style\" | \"title\" | \"onClose\" | \"closable\">;\n\nexport class DialogDOM extends PureComponent<DialogDOMProps> {\n\tel: HTMLDivElement | null = null;\n\tcomponentDidMount() {\n\t\tthis.resetTransformOrigin();\n\t}\n\tcomponentWillUnmount() {\n\t\tthis.resetTransformOrigin();\n\t}\n\n\tresetTransformOrigin({ mousePosition } = this.props) {\n\t\tif (mousePosition && mousePosition.x >= 0 && mousePosition.y >= 0 && this.el) {\n\t\t\tconst { left, top } = this.el.getBoundingClientRect();\n\t\t\tconst origin = `${mousePosition.x - left}px ${mousePosition.y - top}px 0`;\n\t\t\tconst style = this.el.style;\n\t\t\t[\"Webkit\", \"Moz\", \"Ms\", \"ms\"].forEach((prefix) => {\n\t\t\t\tstyle[`${prefix}TransformOrigin` as any] = origin;\n\t\t\t});\n\t\t\tstyle.transformOrigin = origin;\n\t\t}\n\t}\n\tcloseByClick = (e: React.MouseEvent<HTMLButtonElement>) => call(this.props.onClose, e as any);\n\trenderCloseButton() {\n\t\treturn;\n\t}\n\trenderHeader() {\n\t\tlet { title } = this.props;\n\t\tif (!title) return null;\n\t\ttitle = isValidElement(title) || <span className=\"dialog__title__text\">{title}</span>;\n\t\treturn (\n\t\t\t<div className=\"dialog__header\">\n\t\t\t\t<div className=\"dialog__title\">{title}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\trender() {\n\t\tconst { className, closable, footer, style, children } = this.props;\n\t\tconst props = {\n\t\t\tclassName: classnames(\"dialog\", {}),\n\t\t\tstyle,\n\t\t\tref: (el: HTMLDivElement) => (this.el = el),\n\t\t};\n\t\tconst Header = this.renderHeader();\n\t\tconst Footer = footer && <div className=\"dialog__footer\">{footer}</div>;\n\t\treturn (\n\t\t\t<div {...props}>\n\t\t\t\t{Header}\n\t\t\t\t<div className=\"dialog__body\">\n\t\t\t\t\t<div className=\"dialog__main\">{children}</div>\n\t\t\t\t</div>\n\t\t\t\t{Footer}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\ntype DialogOuterProps = Pick<DialogProps, \"overlay\" | \"closeByOverlay\" | \"visible\" | \"onClose\">;\n\nexport class DialogOuter extends PureComponent<DialogOuterProps> {\n\trootRef = createRef<HTMLDivElement>();\n\tcomponentDidMount() {\n\t\tconst activeEl = document.activeElement;\n\t\tconst dialogNode = this.rootRef.current;\n\t\tif (!dialogNode || dialogNode === activeEl || dialogNode.contains(activeEl)) return;\n\t}\n\tclickOverlay = (e: React.MouseEvent) => {\n\t\tconst { onClose, overlay, closeByOverlay } = this.props;\n\t\tif (!overlay || !closeByOverlay || e.target !== e.currentTarget) return;\n\t\tcall(onClose, e as any);\n\t};\n\n\trender() {\n\t\tconst { overlay, visible, children } = this.props;\n\n\t\treturn (\n\t\t\t<div ref={this.rootRef} tabIndex={-1} className=\"dialog__root\">\n\t\t\t\t{visible && overlay && <div className=\"dialog__backdrop\"></div>}\n\t\t\t\t<div className=\"dialog__wrap\" onClick={this.clickOverlay}>\n\t\t\t\t\t{children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n",{"ruleId":"153","severity":1,"message":"154","line":4,"column":10,"nodeType":"155","messageId":"156","endLine":4,"endColumn":16},{"ruleId":"153","severity":1,"message":"157","line":7,"column":10,"nodeType":"155","messageId":"156","endLine":7,"endColumn":17},{"ruleId":"158","replacedBy":"159"},{"ruleId":"160","replacedBy":"161"},{"ruleId":"153","severity":1,"message":"162","line":2,"column":10,"nodeType":"155","messageId":"156","endLine":2,"endColumn":16},{"ruleId":"158","replacedBy":"163"},{"ruleId":"160","replacedBy":"164"},{"ruleId":"165","severity":1,"message":"166","line":86,"column":4,"nodeType":"167","messageId":"168","endLine":86,"endColumn":23,"fix":"169"},{"ruleId":"170","severity":1,"message":"171","line":105,"column":10,"nodeType":"172","messageId":"173","endLine":105,"endColumn":12},{"ruleId":"170","severity":1,"message":"171","line":106,"column":15,"nodeType":"172","messageId":"173","endLine":106,"endColumn":17},{"ruleId":"170","severity":1,"message":"171","line":107,"column":15,"nodeType":"172","messageId":"173","endLine":107,"endColumn":17},{"ruleId":"153","severity":1,"message":"174","line":2,"column":2,"nodeType":"155","messageId":"156","endLine":2,"endColumn":4},{"ruleId":"153","severity":1,"message":"175","line":3,"column":2,"nodeType":"155","messageId":"156","endLine":3,"endColumn":15},{"ruleId":"153","severity":1,"message":"176","line":7,"column":2,"nodeType":"155","messageId":"156","endLine":7,"endColumn":21},{"ruleId":"153","severity":1,"message":"177","line":9,"column":2,"nodeType":"155","messageId":"156","endLine":9,"endColumn":11},{"ruleId":"153","severity":1,"message":"178","line":11,"column":2,"nodeType":"155","messageId":"156","endLine":11,"endColumn":16},{"ruleId":"153","severity":1,"message":"179","line":17,"column":10,"nodeType":"155","messageId":"156","endLine":17,"endColumn":24},{"ruleId":"153","severity":1,"message":"180","line":133,"column":9,"nodeType":"155","messageId":"156","endLine":133,"endColumn":14},{"ruleId":"153","severity":1,"message":"181","line":133,"column":16,"nodeType":"155","messageId":"156","endLine":133,"endColumn":24},{"ruleId":"153","severity":1,"message":"182","line":156,"column":11,"nodeType":"155","messageId":"156","endLine":156,"endColumn":27},{"ruleId":"153","severity":1,"message":"183","line":160,"column":21,"nodeType":"155","messageId":"156","endLine":160,"endColumn":26},{"ruleId":"158","replacedBy":"184"},{"ruleId":"160","replacedBy":"185"},{"ruleId":"158","replacedBy":"186"},{"ruleId":"160","replacedBy":"187"},{"ruleId":"153","severity":1,"message":"174","line":1,"column":10,"nodeType":"155","messageId":"156","endLine":1,"endColumn":12},{"ruleId":"153","severity":1,"message":"175","line":1,"column":14,"nodeType":"155","messageId":"156","endLine":1,"endColumn":27},{"ruleId":"153","severity":1,"message":"177","line":1,"column":58,"nodeType":"155","messageId":"156","endLine":1,"endColumn":67},{"ruleId":"188","severity":1,"message":"189","line":145,"column":5,"nodeType":"190","endLine":145,"endColumn":19},{"ruleId":"158","replacedBy":"191"},{"ruleId":"160","replacedBy":"192"},{"ruleId":"153","severity":1,"message":"174","line":1,"column":10,"nodeType":"155","messageId":"156","endLine":1,"endColumn":12},{"ruleId":"153","severity":1,"message":"175","line":1,"column":14,"nodeType":"155","messageId":"156","endLine":1,"endColumn":27},{"ruleId":"153","severity":1,"message":"193","line":13,"column":8,"nodeType":"155","messageId":"156","endLine":13,"endColumn":18},{"ruleId":"153","severity":1,"message":"194","line":17,"column":51,"nodeType":"155","messageId":"156","endLine":17,"endColumn":63},{"ruleId":"195","severity":1,"message":"196","line":142,"column":5,"nodeType":"197","endLine":142,"endColumn":22,"suggestions":"198"},{"ruleId":"195","severity":1,"message":"199","line":188,"column":5,"nodeType":"197","endLine":188,"endColumn":43,"suggestions":"200"},{"ruleId":"195","severity":1,"message":"201","line":197,"column":5,"nodeType":"197","endLine":197,"endColumn":26,"suggestions":"202"},{"ruleId":"153","severity":1,"message":"203","line":3,"column":18,"nodeType":"155","messageId":"156","endLine":3,"endColumn":29},{"ruleId":"153","severity":1,"message":"204","line":4,"column":21,"nodeType":"155","messageId":"156","endLine":4,"endColumn":32},{"ruleId":"205","severity":2,"message":"206","line":41,"column":20,"nodeType":"155","endLine":41,"endColumn":26},{"ruleId":"207","severity":1,"message":"208","line":7,"column":14,"nodeType":"155","messageId":"209","endLine":7,"endColumn":21},{"ruleId":"153","severity":1,"message":"193","line":1,"column":8,"nodeType":"155","messageId":"156","endLine":1,"endColumn":18},{"ruleId":"153","severity":1,"message":"210","line":2,"column":43,"nodeType":"155","messageId":"156","endLine":2,"endColumn":49},{"ruleId":"153","severity":1,"message":"211","line":3,"column":10,"nodeType":"155","messageId":"156","endLine":3,"endColumn":23},{"ruleId":"153","severity":1,"message":"212","line":4,"column":10,"nodeType":"155","messageId":"156","endLine":4,"endColumn":16},{"ruleId":"153","severity":1,"message":"213","line":68,"column":7,"nodeType":"155","messageId":"156","endLine":68,"endColumn":14},{"ruleId":"153","severity":1,"message":"214","line":52,"column":11,"nodeType":"155","messageId":"156","endLine":52,"endColumn":20},{"ruleId":"153","severity":1,"message":"215","line":52,"column":22,"nodeType":"155","messageId":"156","endLine":52,"endColumn":30},"@typescript-eslint/no-unused-vars","'config' is defined but never used.","Identifier","unusedVar","'version' is defined but never used.","no-native-reassign",["216"],"no-negated-in-lhs",["217"],"'Dialog' is defined but never used.",["216"],["217"],"no-useless-computed-key","Unnecessarily computed property [\"hairline\"] found.","Property","unnecessarilyComputedProperty",{"range":"218","text":"219"},"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'FC' is defined but never used.","'CSSProperties' is defined but never used.","'InputHTMLAttributes' is defined but never used.","'useEffect' is defined but never used.","'HTMLAttributes' is defined but never used.","'preventDefault' is defined but never used.","'model' is assigned a value but never used.","'setModel' is assigned a value but never used.","'handleInputClick' is defined but never used.","'value' is assigned a value but never used.",["216"],["217"],["216"],["217"],"jsx-a11y/aria-role","Elements with ARIA roles must use a valid, non-abstract ARIA role.","JSXAttribute",["216"],["217"],"'classnames' is defined but never used.","'MountElement' is defined but never used.","react-hooks/exhaustive-deps","React Hook useLayoutEffect has a missing dependency: 'style'. Either include it or remove the dependency array.","ArrayExpression",["220"],"React Hook useLayoutEffect has missing dependencies: 'closeAction' and 'onOpen'. Either include them or remove the dependency array.",["221"],"React Hook useEffect has a missing dependency: 'closeAction'. Either include it or remove the dependency array.",["222"],"'PortalProps' is defined but never used.","'DialogOuter' is defined but never used.","react-hooks/rules-of-hooks","React Hook \"useRef\" cannot be called at the top level. React Hooks must be called in a React function component or a custom React Hook function.","@typescript-eslint/no-redeclare","'Context' is already defined.","redeclared","'useRef' is defined but never used.","'CSSTransition' is defined but never used.","'Portal' is defined but never used.","'overlay' is assigned a value but never used.","'className' is assigned a value but never used.","'closable' is assigned a value but never used.","no-global-assign","no-unsafe-negation",[2046,2058],"\"hairline\"",{"desc":"223","fix":"224"},{"desc":"225","fix":"226"},{"desc":"227","fix":"228"},"Update the dependencies array to be: [node, className, style]",{"range":"229","text":"230"},"Update the dependencies array to be: [closeByOverlay, closeByOutside, node, onOpen, closeAction]",{"range":"231","text":"232"},"Update the dependencies array to be: [closeAction, closeByESC, visible]",{"range":"233","text":"234"},[3548,3565],"[node, className, style]",[5084,5122],"[closeByOverlay, closeByOutside, node, onOpen, closeAction]",[5375,5396],"[closeAction, closeByESC, visible]"]